<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>公式ページへ接続中...</title>

    <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._iq||{},n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};
      
      // ★ ここにご自身のピクセルIDを入れます
      ttq.load('【ここにあなたのピクセルIDを入力】'); 
      
      // ページビューは着地と同時に発火（生存確認用）
      ttq.page();
    }(window, document, 'ttq');
    </script>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f5f5f7; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; color: #333; }
        .container { text-align: center; background: #fff; padding: 40px 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); width: 85%; max-width: 400px; }
        .status-text { font-size: 16px; font-weight: bold; margin-bottom: 20px; color: #111; height: 24px; }
        .progress-bg { background: #e0e0e0; border-radius: 8px; height: 20px; width: 100%; overflow: hidden; position: relative; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1); }
        .progress-bar { background: #06C755; height: 100%; width: 0%; transition: width 0.1s linear; }
        .percentage { margin-top: 15px; font-size: 28px; font-weight: bold; color: #06C755; }
        .fallback { margin-top: 20px; font-size: 12px; color: #888; }
        .fallback a { color: #06C755; text-decoration: none; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="status-text" id="status-text">システムに接続中...</div>
        <div class="progress-bg"><div class="progress-bar" id="progress-bar"></div></div>
        <div class="percentage" id="percentage">0%</div>
        <p class="fallback" id="fallback-text" style="display: none;">自動で切り替わらない場合は<a href="https://lin.ee/BkNjD7e">こちら</a>をタップ</p>
    </div>

    <script>
        // ★ 変更完了済
        const targetUrl = "https://lin.ee/BkNjD7e";
        const totalDuration = 2500; 
        const intervalTime = 25; 
        const totalSteps = totalDuration / intervalTime;
        let currentStep = 0;

        const progressBar = document.getElementById("progress-bar");
        const percentageText = document.getElementById("percentage");
        const statusText = document.getElementById("status-text");
        const fallbackText = document.getElementById("fallback-text");

        const interval = setInterval(() => {
            currentStep++;
            let progress = (currentStep / totalSteps) * 100;
            if (progress >= 100) progress = 100;

            progressBar.style.width = progress + "%";
            percentageText.innerText = Math.floor(progress) + "%";

            if (progress > 15 && progress <= 45) {
                statusText.innerText = "特典の空き枠を確認中...";
            } else if (progress > 45 && progress <= 80) {
                statusText.innerText = "受取アカウントを生成中...";
            } else if (progress > 80 && progress < 100) {
                statusText.innerText = "枠の確保が完了しました！";
            }

            // 100%到達時の処理
            if (progress >= 100) {
                clearInterval(interval);
                
                // 100%到達時にのみコンバージョンイベントを発火
                if (typeof ttq !== 'undefined') {
                    ttq.track('ClickButton'); 
                }
                
                setTimeout(() => {
                    window.location.replace(targetUrl);
                    setTimeout(() => { fallbackText.style.display = "block"; }, 1000);
                }, 300);
            }
        }, intervalTime);
    </script>
</body>
</html>
